<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <title>Search Baptismal Records</title>
  <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css" />
  <link href="https://fonts.googleapis.com/css?family=Nunito:200,300,400,700,900" rel="stylesheet" />
  <link href="css/sb-admin-2.min.css" rel="stylesheet" />
</head>

<body id="page-top">
  <div id="wrapper">
    <!-- Sidebar -->
    <ul class="navbar-nav bg-success sidebar sidebar-dark accordion" id="accordionSidebar">
      <!-- Sidebar - Brand -->
      <a class="sidebar-brand d-flex align-items-center justify-content-center" href="index.html">
        <div class="sidebar-brand-icon">
            <img src="logo/tubigonchurch.png" alt="Church Logo" style="width: 75px; height: auto; border-radius: 50%;">
        </div>
    
    </a>
 <li class="nav-item active">
                <a class="nav-link" href="index.html">
                    <i class="fas fa-fw fa-tachometer-alt"></i>
                    <span>Dashboard</span></a>
            </li>
  <!-- Divider -->
            <hr class="sidebar-divider my-0">
        
    <!-- Divider -->
    <hr class="sidebar-divider d-none d-md-block">
 <li class="nav-item active">
                <a class="nav-link" href="search.html">
                    <i class="fas fa-fw fa-tachometer-alt"></i>
                    <span>Search</span></a>
            </li>
            
    <!-- Divider -->
    <hr class="sidebar-divider d-none d-md-block">
             <li class="nav-item active">
                <a class="nav-link" href="display.html">
                    <i class="fas fa-fw fa-tachometer-alt"></i>
                    <span>Display Records</span></a>
            </li>
     <!-- Divider -->
            <hr class="sidebar-divider my-0">

      <hr class="sidebar-divider d-none d-md-block">
            <div class="text-center d-none d-md-inline">
                <button class="rounded-circle border-0" id="sidebarToggle"></button>
            </div>
    </ul>
    <!-- End Sidebar -->

    <!-- Content Wrapper -->
    <div id="content-wrapper" class="d-flex flex-column">
      <div id="content">
          <!-- Topbar -->
                <nav class="navbar navbar-expand navbar-light bg-success topbar mb-4 static-top shadow">
                     <a class="sidebar-brand d-flex align-items-center justify-content-center" href="index.html">
        <div class="sidebar-brand-icon">
          <h6 class="mb-2 text-gray-200 font-weight-bold text-uppercase rounded-circle border-0">San Isidro Labrador Church</h6>
        </div>
       
    </a>
                    <button id="sidebarToggleTop" class="btn btn-link d-md-none rounded-circle mr-3">
                        <i class="fa fa-bars"></i>
                        
                    </button>
                    <ul class="navbar-nav ml-auto">
                        <li class="nav-item dropdown no-arrow">
                            <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button"
                               data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                          <span class="mr-2 d-none d-lg-inline text-dark small">Admin</span>
                                <img class="img-profile rounded-circle" src="img/undraw_profile.svg">
                            </a>
                            <div class="dropdown-menu dropdown-menu-right shadow animated--grow-in"
                                 aria-labelledby="userDropdown">
                              <a class="dropdown-item" href="#">
                                    <i class="fas fa-user fa-sm fa-fw mr-2 text-gray-400"></i>
                                    Profile - Admin
                                </a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="#" data-toggle="modal" data-target="#logoutModal">
                                    <i class="fas fa-sign-out-alt fa-sm fa-fw mr-2 text-gray-400"></i>Logout
                                </a>
                            </div>
                        </li>
                    </ul>
                </nav>
        <!-- End Topbar -->

        <!-- Begin Page Content -->
        <div class="container-fluid">
          <h1 class="h3 mb-4 text-gray-800">Search Baptismal Records</h1>

          <div class="row">
            <div class="col-12">
              <div class="card shadow mb-4 ">
                <div class="card-header py-3 bg-success">
                  <h6 class="m-0 font-weight-bold text-white">Search Baptismal Records</h6>
                </div>
                <div class="card-body bg-dark">
                  <form id="searchForm">
                    <div class="form-group text-white">
                      <label for="searchName">Name (Child or Parent):</label>
                      <input type="text" class="form-control" id="searchName" name="name" placeholder="Enter Child or Parents name" required />
                    </div>
                    <button type="submit" class="btn btn-success mt-2">
                      <i class="fas fa-search"></i> Search Records
                    </button>
                  </form>

                  <div id="resultMessage" class="mt-3 font-weight-bold"></div>

                  <!-- Results Table Container -->
                  <div id="resultsContainer" class="mt-4" style="display:none;">
                    <div class="table-responsive">
                      <table class="table table-bordered table-hover text-white" width="100%" cellspacing="0">
                        <thead class="thead-light">
                          <tr>
                            <th>#</th>
                            <th>Child Name</th>
                            <th>Parents</th>
                            <th>Date of Baptism</th>
                            <th>Godparents</th>
                            <th>Minister</th>
                             <th>Payment</th>
                            <th>Actions</th>
                          </tr>
                        </thead>
                        <tbody id="recordsTableBody">
                          <!-- JS will inject rows here -->
                        </tbody>
                      </table>
                    </div>
                  </div>

                  <!-- Edit Form -->
                  <div id="editFormContainer" class="mt-4 text-white" style="display:none;">
                    <h5>Edit Record</h5>
                    <form id="editForm">
                      <input type="hidden" id="editIndex" />
                      <div class="form-group text-white">
                        <label for="editChild">Child Name</label>
                        <input type="text" class="form-control" id="editChild" required />
                      </div>
                      <div class="form-group text-white">
                        <label for="editParents">Parents</label>
                        <input type="text" class="form-control" id="editParents" required />
                      </div>
                      <div class="form-group text-white">
                        <label for="editDate">Date of Baptism</label>
                        <input type="date" class="form-control" id="editDate" required />
                      </div>
                      <div class="form-group text-white">
                        <label for="editGodparents">Godparents</label>
                        <input type="text" class="form-control" id="editGodparents" />
                      </div>
                      <div class="form-group text-white">
                        <label for="editMinister">Minister</label>
                        <input type="text" class="form-control" id="editMinister" />
                      </div>
                      <button type="submit" class="btn btn-success">Save Changes</button>
                      <button type="button" class="btn btn-secondary ml-2" id="cancelEditBtn">Cancel</button>
                    </form>
                  </div>

                </div>
              </div>
            </div>
          </div>

        </div>
        <!-- /.container-fluid -->
      </div>
      <!-- End of Main Content -->

      <!-- Footer -->
     <footer class="sticky-footer bg-white">
                <div class="container my-auto">
                    <div class="copyright text-center my-auto">
                        <span>@Copyright &copy; San Isidro Labrador Church 2025</span>
                   <div class="credits">
      <!-- All the links in the footer should remain intact. -->
      <!-- You can delete the links only if you've purchased the pro version. -->
      <!-- Licensing information: https://bootstrapmade.com/license/ -->
      <!-- Purchase the pro version with working PHP/AJAX contact form: [buy-url] -->
      Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a>
    </div>
                    </div>
                </div>
            </footer>
      <!-- End of Footer -->
    </div>
    <!-- End of Content Wrapper -->
  </div>
  <!-- End of Page Wrapper -->

  <!-- Scroll to Top Button-->
  <a class="scroll-to-top rounded" href="#page-top">
    <i class="fas fa-angle-up"></i>
  </a>

  <!-- Bootstrap core JavaScript-->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <!-- Core plugin JavaScript-->
  <script src="vendor/jquery-easing/jquery.easing.min.js"></script>
  <!-- Custom scripts for all pages-->
  <script src="js/sb-admin-2.min.js"></script>

  <script>
    // Detailed records array
    let records = [
      { child: "Juan Dela Cruz", parents: "Pedro & Maria Dela Cruz", date: "2020-01-15", godparents: "Carlos & Ana", minister: "Fr. Jose" },
    { child: "Maria Santos", parents: "Jose & Lucia Santos", date: "2020-02-20", godparents: "Luis & Carmen", minister: "Fr. Miguel" },
    { child: "Pedro Reyes", parents: "Ramon & Teresa Reyes", date: "2020-03-05", godparents: "Enrique & Rosa", minister: "Fr. John" },
    { child: "Ana Dela Cruz", parents: "Pedro & Maria Dela Cruz", date: "2020-04-12", godparents: "Carlos & Ana", minister: "Fr. Jose" },
    { child: "Jose Santos", parents: "Jose & Lucia Santos", date: "2020-05-23", godparents: "Luis & Carmen", minister: "Fr. Miguel" },
    { child: "Luisa Gomez", parents: "Miguel & Sofia Gomez", date: "2020-06-15", godparents: "Raul & Elena", minister: "Fr. Paul" },
    { child: "Carlos Mendoza", parents: "Victor & Alicia Mendoza", date: "2020-07-19", godparents: "Mario & Clara", minister: "Fr. John" },
    { child: "Rosa Fernandez", parents: "Jose & Maria Fernandez", date: "2020-08-11", godparents: "Luis & Ana", minister: "Fr. Miguel" },
    { child: "Luis Santos", parents: "Jose & Lucia Santos", date: "2020-09-07", godparents: "Carlos & Carmen", minister: "Fr. Paul" },
    { child: "Elena Cruz", parents: "Pedro & Maria Cruz", date: "2020-10-01", godparents: "Enrique & Rosa", minister: "Fr. Jose" },
    { child: "Miguel Ramirez", parents: "Juan & Teresa Ramirez", date: "2020-11-14", godparents: "Mario & Clara", minister: "Fr. John" },
    { child: "Teresa Lopez", parents: "Carlos & Ana Lopez", date: "2020-12-25", godparents: "Raul & Elena", minister: "Fr. Paul" },
    { child: "Ana Santos", parents: "Jose & Lucia Santos", date: "2021-01-15", godparents: "Luis & Carmen", minister: "Fr. Miguel" },
    { child: "Pedro Gomez", parents: "Miguel & Sofia Gomez", date: "2021-02-20", godparents: "Carlos & Ana", minister: "Fr. Jose" },
    { child: "Maria Mendoza", parents: "Victor & Alicia Mendoza", date: "2021-03-17", godparents: "Mario & Clara", minister: "Fr. John" },
    { child: "Juan Fernandez", parents: "Jose & Maria Fernandez", date: "2021-04-22", godparents: "Luis & Ana", minister: "Fr. Paul" },
    { child: "Carmen Santos", parents: "Jose & Lucia Santos", date: "2021-05-10", godparents: "Carlos & Carmen", minister: "Fr. Miguel" },
    { child: "Clara Ramirez", parents: "Juan & Teresa Ramirez", date: "2021-06-14", godparents: "Enrique & Rosa", minister: "Fr. Jose" },
    { child: "Raul Lopez", parents: "Carlos & Ana Lopez", date: "2021-07-08", godparents: "Raul & Elena", minister: "Fr. Paul" },
    { child: "Elena Gomez", parents: "Miguel & Sofia Gomez", date: "2021-08-19", godparents: "Mario & Clara", minister: "Fr. John" },
    ];
const paymentPerRecord = 300;
  const searchForm = document.getElementById("searchForm");
  const resultDiv = document.getElementById("resultMessage");
  const resultsContainer = document.getElementById("resultsContainer");
  const tableBody = document.getElementById("recordsTableBody");
  const editFormContainer = document.getElementById("editFormContainer");
  const editForm = document.getElementById("editForm");

  function renderTable(recordsToRender) {
    tableBody.innerHTML = "";
    recordsToRender.forEach((rec, index) => {
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${index + 1}</td>
        <td>${rec.child}</td>
        <td>${rec.parents}</td>
        <td>${rec.date}</td>
        <td>${rec.godparents}</td>
        <td>${rec.minister}</td>
        <td>₱${paymentPerRecord.toLocaleString()}</td>
        <td>
          <button class="btn btn-sm btn-info btn-edit" data-index="${index}"><i class="fas fa-edit"></i> Edit</button>
          <button class="btn btn-sm btn-danger btn-delete" data-index="${index}"><i class="fas fa-trash"></i> Delete</button>
        </td>
      `;
      tableBody.appendChild(row);
    });

    // Attach event listeners
    document.querySelectorAll(".btn-edit").forEach(btn => {
      btn.addEventListener("click", (e) => {
        const idx = e.currentTarget.getAttribute("data-index");
        openEditForm(idx);
      });
    });

    document.querySelectorAll(".btn-delete").forEach(btn => {
      btn.addEventListener("click", (e) => {
        const idx = e.currentTarget.getAttribute("data-index");
        deleteRecord(idx);
      });
    });
  }

  function openEditForm(index) {
    const rec = records[index];
    editFormContainer.style.display = "block";
    editForm["editIndex"].value = index;
    editForm["editChild"].value = rec.child;
    editForm["editParents"].value = rec.parents;
    editForm["editDate"].value = rec.date;
    editForm["editGodparents"].value = rec.godparents;
    editForm["editMinister"].value = rec.minister;
    editForm["editPayment"].value = `₱${paymentPerRecord.toLocaleString()}`;
    window.scrollTo({ top: editFormContainer.offsetTop - 20, behavior: "smooth" });
  }

  function deleteRecord(index) {
    if (confirm("Are you sure you want to delete this record?")) {
      records.splice(index, 1);
      resultDiv.textContent = "Record deleted.";
      resultsContainer.style.display = records.length ? "block" : "none";
      renderTable(records);
      editFormContainer.style.display = "none";
    }
  }

  searchForm.addEventListener("submit", function (event) {
    event.preventDefault();
    const inputName = document.getElementById("searchName").value.trim().toLowerCase();

    editFormContainer.style.display = "none";
    resultDiv.textContent = "";
    tableBody.innerHTML = "";
    resultsContainer.style.display = "none";

    if (!inputName) {
      resultDiv.textContent = "Please enter a name.";
      return;
    }

    const matchedRecords = records.filter(rec =>
      rec.child.toLowerCase().includes(inputName) ||
      rec.parents.toLowerCase().includes(inputName)||rec.date.toLowerCase().includes(inputName)
    );

    if (matchedRecords.length === 0) {
      resultDiv.textContent = `No record found for the name "${inputName}".`;
      return;
    }

    resultDiv.textContent = `Found ${matchedRecords.length} record(s) matching "${inputName}":`;
    resultsContainer.style.display = "block";
    renderTable(matchedRecords);

    // Update indexes for edit/delete buttons
    Array.from(tableBody.querySelectorAll("tr")).forEach((tr, i) => {
      const rec = matchedRecords[i];
      const originalIndex = records.indexOf(rec);
      tr.querySelector(".btn-edit").setAttribute("data-index", originalIndex);
      tr.querySelector(".btn-delete").setAttribute("data-index", originalIndex);
    });
  });

  editForm.addEventListener("submit", function (event) {
    event.preventDefault();

    const idx = parseInt(editForm["editIndex"].value, 10);
    if (isNaN(idx) || idx < 0 || idx >= records.length) {
      alert("Invalid record index.");
      return;
    }

    // Update the record (payment is fixed and not editable)
    records[idx] = {
      child: editForm["editChild"].value.trim(),
      parents: editForm["editParents"].value.trim(),
      date: editForm["editDate"].value,
      godparents: editForm["editGodparents"].value.trim(),
      minister: editForm["editMinister"].value.trim()
    };

    resultDiv.textContent = "Record updated successfully.";
    editFormContainer.style.display = "none";

    // Refresh search
    searchForm.dispatchEvent(new Event("submit"));
  });

  document.getElementById("cancelEditBtn").addEventListener("click", () => {
    editFormContainer.style.display = "none";
  });
</script>
</body>

</html>
